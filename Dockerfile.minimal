# 最小化Dockerfile
FROM node:16-alpine

WORKDIR /app

# 只复制必要的文件
COPY frontend/package*.json ./frontend/
COPY backend/package*.json ./backend/

# 安装依赖
RUN cd frontend && npm install --production
RUN cd ../backend && npm install --production

# 复制源代码
COPY frontend ./frontend
COPY backend ./backend

EXPOSE 3000 4000

CMD ["sh", "-c", "cd backend && node index.js & cd ../frontend && npm run dev"]

